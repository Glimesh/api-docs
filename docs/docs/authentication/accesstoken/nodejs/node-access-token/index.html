<!DOCTYPE html>
<html lang="en" dir=>

<head>
  <meta name="generator" content="Hugo 0.79.1" />
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Getting User Tokens With NodeJS #  This is a basic tutorial for getting an auth token from a user using Oauth with NodeJS. This guide assumes you know basic JS and understand the workings of Oauth 2.
 Need a refresh? This tutorial explains the basics of Oauth 2 https://darutk.medium.com/the-simplest-guide-to-oauth-2-0-8c71bd9a15bb
 Creating the Project #  We need to create a basic project. In your terminal type:
npm init -y">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="" />
<meta property="og:description" content="Getting User Tokens With NodeJS #  This is a basic tutorial for getting an auth token from a user using Oauth with NodeJS. This guide assumes you know basic JS and understand the workings of Oauth 2.
 Need a refresh? This tutorial explains the basics of Oauth 2 https://darutk.medium.com/the-simplest-guide-to-oauth-2-0-8c71bd9a15bb
 Creating the Project #  We need to create a basic project. In your terminal type:
npm init -y" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://glimesh.github.io/api-docs/docs/authentication/accesstoken/nodejs/node-access-token/" />
<meta property="article:modified_time" content="2021-02-23T12:58:15-06:00" />
<title>Node Access Token | API-Docs</title>
<link rel="manifest" href="/api-docs/manifest.json">
<link rel="icon" href="/api-docs/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/api-docs/book.min.4b53eeb588f75ee8d167188c6112d5918363d01776e01745616156129efa4644.css" integrity="sha256-S1PutYj3XujRZxiMYRLVkYNj0Bd24BdFYWFWEp76RkQ=">
<script defer src="/api-docs/en.search.min.a38bb601a228f6c86816828c8a655df5d2c20414339d86f58a31819767a742f6.js" integrity="sha256-o4u2AaIo9shoFoKMimVd9dLCBBQznYb1ijGBl2enQvY="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  <script src="https://kit.fontawesome.com/a076d05399.js"></script>

<script src="https://cdn.jsdelivr.net/npm/react@16/umd/react.production.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/react-dom@16/umd/react-dom.production.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.css"/>
<script src="https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.min.js"></script>
</head>

<body dir=>
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/api-docs"><img src="/api-docs/glimesh.png" alt="Logo" /><span>API-Docs</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bf7b3283e3790c00c8caaa140299052b" class="toggle"  />
    <label for="section-bf7b3283e3790c00c8caaa140299052b" class="flex justify-between">
      <a  class="">Api</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ed8e1e4d4f4c1e3672708d733258fa51" class="toggle"  />
    <label for="section-ed8e1e4d4f4c1e3672708d733258fa51" class="flex justify-between">
      <a  class="">Live Updates</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/live-updates/channels/" class="">Channels</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/live-updates/followers/" class="">Followers</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ed972e555096d8550e03791bdee2d785" class="toggle"  />
    <label for="section-ed972e555096d8550e03791bdee2d785" class="flex justify-between">
      <a  class="">Query Api</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/query-api/basic-query/" class="">Basic Query</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/query-api/nodejs/node-query/" class="">Node Query</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/api/voyager/" class="">Voyager</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-46070fb9a15f8281e5989a88905887d2" class="toggle" checked />
    <label for="section-46070fb9a15f8281e5989a88905887d2" class="flex justify-between">
      <a  class="">Authentication</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cd9d01c15ace32e6fd3da5d1201bcd57" class="toggle" checked />
    <label for="section-cd9d01c15ace32e6fd3da5d1201bcd57" class="flex justify-between">
      <a  class="">Access Token</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/accesstoken/clientcredentials/" class="">Client Credentials</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/accesstoken/accesstoken/" class="">Access Token</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/accesstoken/nodejs/node-access-token/" class=" active">Node Access Token</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1a1dc1f670e3426ff413fcd1f7e7ec36" class="toggle"  />
    <label for="section-1a1dc1f670e3426ff413fcd1f7e7ec36" class="flex justify-between">
      <a  class="">Refresh Token</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/authentication/refreshtoken/refreshtoken/" class="">Refresh Token</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-05db2d31fc2e5a419ce9fd1c0e938e4e" class="toggle"  />
    <label for="section-05db2d31fc2e5a419ce9fd1c0e938e4e" class="flex justify-between">
      <a  class="">Chat</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9c7ac9316f3056fdea1a344042fc8cb8" class="toggle"  />
    <label for="section-9c7ac9316f3056fdea1a344042fc8cb8" class="flex justify-between">
      <a  class="">Projects</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/projects/sitewidesubscription/" class="">Site Wide Subscription</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/chat-tokens/" class="">Chat Tokens</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/moderation/" class="">Moderation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/mutations/" class="">Mutations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/chat/websockets/" class="">Websockets</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-084ba1dbb512652712ad881ff8045610" class="toggle"  />
    <label for="section-084ba1dbb512652712ad881ff8045610" class="flex justify-between">
      <a  class="">Reference</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/channel/" class="">Channel</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/chat/" class="">Chat</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/chatparts/" class="">Chat Parts</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/mod/" class="">Mod</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/reference/scopes/" class="">Scopes</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/contributing/" class="">Contributing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/dev-app/" class="">Dev App</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c51f25d1917de848e9ad26913759c6eb" class="toggle"  />
    <label for="section-c51f25d1917de848e9ad26913759c6eb" class="flex justify-between">
      <a  class="">Developer Resources</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://glimesh.github.io/api-docs/docs/developerresources/libraries/" class="">Libraries</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/api-docs/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Node Access Token</strong>

  <label for="toc-control">
    
    <img src="/api-docs/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  <nav id="TableOfContents">
  <ul>
    <li><a href="#creating-the-project">Creating the Project</a></li>
    <li><a href="#starting-up">Starting Up</a></li>
    <li><a href="#creating-the-server">Creating the server</a></li>
    <li><a href="#developer-applications">Developer Applications</a></li>
    <li><a href="#getting-the-token">Getting the Token</a></li>
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="getting-user-tokens-with-nodejs">
  Getting User Tokens With NodeJS
  <a class="anchor" href="#getting-user-tokens-with-nodejs">#</a>
</h1>
<p>This is a basic tutorial for getting an auth token from a user using Oauth with NodeJS. This guide assumes you know basic JS and understand the workings of Oauth 2.</p>
<blockquote>
<p>Need a refresh? This tutorial explains the basics of Oauth 2
<a href="https://darutk.medium.com/the-simplest-guide-to-oauth-2-0-8c71bd9a15bb">https://darutk.medium.com/the-simplest-guide-to-oauth-2-0-8c71bd9a15bb</a></p>
</blockquote>
<h2 id="creating-the-project">
  Creating the Project
  <a class="anchor" href="#creating-the-project">#</a>
</h2>
<p>We need to create a basic project. In your terminal type:</p>
<p><code>npm init -y</code></p>
<p>This will create a project.JSON file. This project uses the
<a href="https://www.npmjs.com/package/request">Express</a>  and <a href="https://www.npmjs.com/package/request">Request</a> packages.  Install them with:</p>
<p><code>npm install express request</code></p>
<p>These packages will help us set up a basic web server and send requests to Glimesh.</p>
<h2 id="starting-up">
  Starting Up
  <a class="anchor" href="#starting-up">#</a>
</h2>
<p>In your project create a blank JS file. I will title mine <strong>auth.js</strong>. Start by importing Express. Paste this at the top of your file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;express&#39;</span>); <span style="color:#75715e">//Express package
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>(); <span style="color:#75715e">// Creates endpoints for the server.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">request</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;request&#39;</span>); <span style="color:#75715e">//Request package
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">clientID</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>; <span style="color:#75715e">// ID for connecting your users to your app.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">secretID</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>; <span style="color:#75715e">//ID to verify your app, keep private.
</span><span style="color:#75715e"></span>
</code></pre></div><p>This imports the modules our server will need. The server will use the <em>app</em> variable for creating endpoints. The IDs are used so Glimesh can identify our app. We will insert the IDs later.</p>
<h2 id="creating-the-server">
  Creating the server
  <a class="anchor" href="#creating-the-server">#</a>
</h2>
<p>First we need to tell the server to listen for connections. We also need to tell the server which port to be on. I would recommend 8080 or 3000.
Paste this in your file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">PORT</span> <span style="color:#f92672">||</span> <span style="color:#ae81ff">3000</span>; <span style="color:#75715e">//Opens the server on port 3000
</span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">port</span>, () =&gt;  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;App listening on port &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">port</span>));
<span style="color:#75715e">//keeps the server running^
</span><span style="color:#75715e"></span>
</code></pre></div><p>This will keep the server from closing by itself. Now we can create endpoints for our users to connect to. One will redirect to the Glimesh auth page (<strong>/oauth/authorize</strong>) and the other will handle the auth info sent from Glimesh. You can create a web page for the first endpoint if you wish. For the sake of this tutorial I will keep it a simple redirect.
Paste this in your file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">
<span style="color:#75715e">//When a user visits http://localhost:3000/auth
</span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/auth&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
<span style="color:#75715e">//redirects the user to the glimesh authenication page
</span><span style="color:#75715e"></span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">redirect</span>(<span style="color:#ae81ff">301</span>, <span style="color:#e6db74">&#39;https://glimesh.tv/oauth/authorize?response_type=code&amp;state=&amp;client_id=&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">clientID</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&amp;scope=public%20email%20chat%20streamkey&amp;redirect_uri=http://localhost:3000/success&#39;</span>);
});

</code></pre></div><p>In this URL we send the client ID,  the redirect URL,  and a set of scopes that we want access to. We also request a code in the <em>response_type</em>. Next we will create a developer application. This will give us a client ID and a secret ID.</p>
<blockquote>
<p>If you have a web page that you want your users to access when they go to this endpoint you can send it to them by using <code>res.sendFile(&quot;FILE_NAME.html&quot;)</code>
You would need to have a button or other method to send them to the authentication page.</p>
</blockquote>
<h2 id="developer-applications">
  Developer Applications
  <a class="anchor" href="#developer-applications">#</a>
</h2>
<p>Before we can request Oauth permissions we need a developer application. This is what Glimesh will use to authenticate users for your app. It is also how Glimesh can monitor and identify requests you and your users send.  Click <a href="https://glimesh.tv/users/settings/applications">here</a> to create your developer application.</p>
<p><img src="https://i.imgur.com/BLIe7Tx.png" alt="Create Dev Image" /></p>
<p>Set up your dev application like this.  Use a unique name and description. You can update these at any time.
<img src="https://i.imgur.com/LOIJVyt.png" alt="Edit Dev Image" /></p>
<p>Ensure that the homepage of your app is <code>http://localhost:3000</code> and your redirect link is <code>http://localhost:3000/success</code>. You <strong>must</strong> replace the port number if you used a different port.</p>
<p>Save your app when you are finished.</p>
<h2 id="getting-the-token">
  Getting the Token
  <a class="anchor" href="#getting-the-token">#</a>
</h2>
<p>Now that we have a developer app we can update our variables. Set it equal to your client ID and secret ID. It is very important to keep the secret ID hidden from your users. If your ID is leaked you can reset them from the Glimesh dev app page but your users must authenticate again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">clientID</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CLIENT_ID_HERE&#34;</span>
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">secretID</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SECRET_HERE&#34;</span>

</code></pre></div><p>We need to create an endpoint for Glimesh to redirect to. In the previous section we told Glimesh to redirect to <code>locahhost:3000/success</code>. Let&rsquo;s create it!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">
<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;/success&#34;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">query</span>.<span style="color:#a6e22e">code</span>;
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;The code is &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">code</span>);
  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">`&lt;h1&gt;code recieved!&lt;/h1&gt;`</span>)  <span style="color:#75715e">//Sends a confirmation message to the user
</span><span style="color:#75715e"></span>});

</code></pre></div><p>When our user is redirected to our server the token is sent in the URL as <code>?code=CODE_HERE</code>. We pull the code from URL and log it to the console.</p>
<p>Once you have the code you can request the token from Glimesh. This can be done with a simple Request function. When we get a response we parse it and log it to the console. Update the code for the <code>/success</code> endpoint as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">
<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;/success&#34;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">query</span>.<span style="color:#a6e22e">code</span>;
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;The code is &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">code</span>);
    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">`&lt;h1&gt;Code recieved, requesting token!&lt;/h1&gt;`</span>) <span style="color:#75715e">//Sends a confirm message to the user
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//Now we send this code to Glimesh to ask for a token.
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> {
        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
        <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>,
        <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://glimesh.tv/api/oauth/token?grant_type=authorization_code&amp;code=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&amp;redirect_uri=http://localhost:3000/success&amp;client_id=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">clientID</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&amp;client_secret=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">secretID</span>
    };
    <span style="color:#a6e22e">request</span>(<span style="color:#a6e22e">options</span>, (<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">response</span>, <span style="color:#a6e22e">body</span>) =&gt; {
        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">error</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">statusCode</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">200</span>) { <span style="color:#75715e">//If all is as it should be
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">body</span>); <span style="color:#75715e">//The unfiltered response
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">body</span>);
            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">data</span>)
        } <span style="color:#66d9ef">else</span> {
            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">error</span>) <span style="color:#75715e">//log any errors
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">statusCode</span>)
            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">body</span>)
        }
    });
});

</code></pre></div><p>Save the file when you are finished. Let&rsquo;s test our code! In your terminal type:</p>
<p><code>node FILE_NAME.js</code></p>
<p>Replace FILE_NAME with the name of your file. This will start up the web server. Some antivirus programs may block the process because other devices on your network can access this server. Simply allow the port number you used in your antivirus software if this is the case. You may want to restart the server.</p>
<p>Once that is complete and the server is running head to <code>http://localhost:3000/auth</code> replacing the port number with the correct port. It will redirect you to your client application page. Accept it and it will redirect you back to your server at the <code>/success</code> endpoint.</p>
<blockquote>
<p>Please note that you must be logged in before authorizing. A bug prevents you from entering your account info and proceeding to the client app screen.
If you are not logged in you must sign in and then go back to <code>/auth</code></p>
</blockquote>
<p><img src="https://i.imgur.com/fWawNSS.png" alt="Auth Image" /></p>
<p>You should see a confirmation message in your browser. The server is now sending the code back to Glimesh to request a token. Check the console in your terminal to see the code!</p>
<p><img src="https://i.imgur.com/67sv2eV.png" alt="Imgur" /></p>
<p>You can use the <em>access_token</em> to query the API on the users behalf. This will expire after a few hours so you will need to refresh the token or get a new one.  If you have any question talk to us in the #dev channel in our <a href="https://discord.gg/Glimesh">Discord</a>.  We would love to hear what you are making!</p>
<p>The full file can be found here.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;express&#39;</span>); <span style="color:#75715e">//Express package
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>(); <span style="color:#75715e">// Creates endpoints for the server.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">request</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;request&#39;</span>); <span style="color:#75715e">//Request package
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">clientID</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>; <span style="color:#75715e">// ID for connecting your users to your app.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">secretID</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>; <span style="color:#75715e">//ID to verify your app, keep private.
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">PORT</span> <span style="color:#f92672">||</span> <span style="color:#ae81ff">3000</span>; <span style="color:#75715e">//Opens the server on port 3000
</span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">port</span>, () =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;App listening on port &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">port</span>));
<span style="color:#75715e">//keeps the server running^
</span><span style="color:#75715e"></span>
<span style="color:#75715e">//When a user visits http://localhost:3000/auth
</span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/auth&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
	<span style="color:#75715e">//redirects the user to the glimesh authenication page
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">redirect</span>(<span style="color:#ae81ff">301</span>, <span style="color:#e6db74">&#39;https://glimesh.tv/oauth/authorize?response_type=code&amp;state=&amp;client_id=&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">clientID</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&amp;scope=public%20email%20chat%20streamkey&amp;redirect_uri=http://localhost:3000/success&#39;</span>);
});

<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;/success&#34;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
	<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">query</span>.<span style="color:#a6e22e">code</span>;
	<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;The code is &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">code</span>);
	<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">`&lt;h1&gt;Code Recieved!&lt;/h1&gt;`</span>) <span style="color:#75715e">//Sends a confirm message to the user
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//Now we send this code to Glimesh to ask for a token.
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> {
		<span style="color:#a6e22e">method</span><span style="color:#f92672">:</span>  <span style="color:#e6db74">&#39;POST&#39;</span>,
		<span style="color:#a6e22e">body</span><span style="color:#f92672">:</span>  <span style="color:#e6db74">&#34;&#34;</span>,
		<span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://glimesh.tv/api/oauth/token?grant_type=authorization_code&amp;code=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&amp;redirect_uri=http://localhost:3000/success&amp;client_id=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">clientID</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&amp;client_secret=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">secretID</span>
	};
	<span style="color:#a6e22e">request</span>(<span style="color:#a6e22e">options</span>, (<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">response</span>, <span style="color:#a6e22e">body</span>) =&gt; { <span style="color:#75715e">//Send glimesh the code for a token in return
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">error</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">statusCode</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">200</span>) { <span style="color:#75715e">//If all is as it should be
</span><span style="color:#75715e"></span>			<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">body</span>); <span style="color:#75715e">//The unfiltered response
</span><span style="color:#75715e"></span>			<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">body</span>); <span style="color:#75715e">//The parsed response
</span><span style="color:#75715e"></span>			<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">data</span>) <span style="color:#75715e">// The data we want!
</span><span style="color:#75715e"></span>		} <span style="color:#66d9ef">else</span> {
			<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">error</span>) <span style="color:#75715e">//log any errors
</span><span style="color:#75715e"></span>			<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">statusCode</span>) <span style="color:#75715e">//Status code if an error occurs
</span><span style="color:#75715e"></span>			<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">body</span>) <span style="color:#75715e">//The body for more info
</span><span style="color:#75715e"></span>		}
	});
});

</code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">



  <div><a class="flex align-center" href="https://github.com/Glimesh/api-docs/commit/55504d3fd17f2022328cb5c0b8b27d0cf7af17bc" title='Last modified by MythoAway7 | February 23, 2021' target="_blank" rel="noopener">
      <img src="/api-docs/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>February 23, 2021</span>
    </a>
  </div>



</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#creating-the-project">Creating the Project</a></li>
    <li><a href="#starting-up">Starting Up</a></li>
    <li><a href="#creating-the-server">Creating the server</a></li>
    <li><a href="#developer-applications">Developer Applications</a></li>
    <li><a href="#getting-the-token">Getting the Token</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












