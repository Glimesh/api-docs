<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.105.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Chat Tokens # Chat tokens are a different way to handle messages sent from chat. A normal message is just a simple string. A chat token is an array of data that shows you all sorts of information about the message and what it contains.
This is a continuation of the websocket tutorial. If you have not already completed the tutorial you can do so here. A chat connection is required for this tutorial."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Tokens (Message Parts)"><meta property="og:description" content="Chat Tokens # Chat tokens are a different way to handle messages sent from chat. A normal message is just a simple string. A chat token is an array of data that shows you all sorts of information about the message and what it contains.
This is a continuation of the websocket tutorial. If you have not already completed the tutorial you can do so here. A chat connection is required for this tutorial."><meta property="og:type" content="article"><meta property="og:url" content="https://glimesh.github.io/api-docs/docs/chat/chat-tokens/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-10-15T14:35:05-05:00"><title>Tokens (Message Parts) | API-Docs</title><link rel=manifest href=/api-docs/manifest.json><link rel=icon href=/api-docs/favicon.png type=image/x-icon><link rel=stylesheet href=/api-docs/book.min.8cbfebb3cede38504cf8ec2af15528c78f5d6c0aa02b6e39dcffcd3320289b34.css integrity="sha256-jL/rs87eOFBM+Owq8VUox49dbAqgK2453P/NMyAomzQ="><script defer src=/api-docs/en.search.min.27028cd672cf068946d1e14dec17c1b42847582ec2e5f4973ea8723ef047c09f.js integrity="sha256-JwKM1nLPBolG0eFN7BfBtChHWC7C5fSXPqhyPvBHwJ8="></script>
<script src=https://kit.fontawesome.com/a076d05399.js></script>
<script src=https://cdn.jsdelivr.net/npm/react@16/umd/react.production.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/react-dom@16/umd/react-dom.production.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.css><script src=https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.min.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/api-docs><img src=/api-docs/glimesh.png alt=Logo><span>API-Docs</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-bf7b3283e3790c00c8caaa140299052b class=toggle>
<label for=section-bf7b3283e3790c00c8caaa140299052b class="flex justify-between"><a>API</a>
<span>▾</span></label><ul><li><input type=checkbox id=section-ed972e555096d8550e03791bdee2d785 class=toggle>
<label for=section-ed972e555096d8550e03791bdee2d785 class="flex justify-between"><a>API Queries</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/api/query-api/basic-query/>Generic Query</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/query-api/nodejs/node-query/>NodeJS Query</a></li></ul></li><li><input type=checkbox id=section-8c27155e24a80e56e9d44dbeacd7d1ea class=toggle>
<label for=section-8c27155e24a80e56e9d44dbeacd7d1ea class="flex justify-between"><a>Stream Settings</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/api/stream/updatestreaminfo/>Update Stream Info</a></li></ul></li><li><a href=https://glimesh.github.io/api-docs/docs/api/api-explorer/>API Explorer</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/migration/>Migration</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/pagination/>Pagination</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/voyager/>Voyager</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/glimesh-ids/>Glimesh IDs</a></li></ul></li><li><input type=checkbox id=section-46070fb9a15f8281e5989a88905887d2 class=toggle>
<label for=section-46070fb9a15f8281e5989a88905887d2 class="flex justify-between"><a>Authentication</a>
<span>▾</span></label><ul><li><input type=checkbox id=section-cd9d01c15ace32e6fd3da5d1201bcd57 class=toggle>
<label for=section-cd9d01c15ace32e6fd3da5d1201bcd57 class="flex justify-between"><a>Access Token</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/authentication/accesstoken/clientcredentials/>Client Credentials</a></li><li><a href=https://glimesh.github.io/api-docs/docs/authentication/accesstoken/pkceauth/>PKCE</a></li><li><a href=https://glimesh.github.io/api-docs/docs/authentication/accesstoken/accesstoken/>Access Token</a></li><li><a href=https://glimesh.github.io/api-docs/docs/authentication/accesstoken/nodejs/node-access-token/>NodeJS Access Token</a></li></ul></li><li><input type=checkbox id=section-1a1dc1f670e3426ff413fcd1f7e7ec36 class=toggle>
<label for=section-1a1dc1f670e3426ff413fcd1f7e7ec36 class="flex justify-between"><a>Refresh Token</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/authentication/refreshtoken/refreshtoken/>Refresh Token</a></li></ul></li><li><a href=https://glimesh.github.io/api-docs/docs/authentication/auth-explained/>Auth Explained</a></li></ul></li><li><input type=checkbox id=section-05db2d31fc2e5a419ce9fd1c0e938e4e class=toggle checked>
<label for=section-05db2d31fc2e5a419ce9fd1c0e938e4e class="flex justify-between"><a>Chat</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/chat/websockets/>Connecting to Chat</a></li><li><a href=https://glimesh.github.io/api-docs/docs/chat/mutations/>Sending Messages</a></li><li><a href=https://glimesh.github.io/api-docs/docs/chat/chat-tokens/ class=active>Tokens (Message Parts)</a></li><li><a href=https://glimesh.github.io/api-docs/docs/chat/moderation/>Moderation</a></li><li><input type=checkbox id=section-9c7ac9316f3056fdea1a344042fc8cb8 class=toggle>
<label for=section-9c7ac9316f3056fdea1a344042fc8cb8 class="flex justify-between"><a>Projects</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/chat/projects/sitewidesubscription/>Site Wide Subscription</a></li><li><a href=https://glimesh.github.io/api-docs/docs/chat/projects/typescriptchatbot/>Typescript Chatbot</a></li></ul></li></ul></li><li><input type=checkbox id=section-0bc4e29f34ae087e007863102c5ba992 class=toggle>
<label for=section-0bc4e29f34ae087e007863102c5ba992 class="flex justify-between"><a>Live Updates</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/live-updates/channels/>Channels</a></li><li><a href=https://glimesh.github.io/api-docs/docs/live-updates/followers/>Followers</a></li><li><a href=https://glimesh.github.io/api-docs/docs/live-updates/subscribers/>Subscribers</a></li><li><a href=https://glimesh.github.io/api-docs/docs/live-updates/explanation/>Live Updates Explained</a></li></ul></li><li><input type=checkbox id=section-084ba1dbb512652712ad881ff8045610 class=toggle>
<label for=section-084ba1dbb512652712ad881ff8045610 class="flex justify-between"><a>Reference</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/reference/channel/>Channel</a></li><li><a href=https://glimesh.github.io/api-docs/docs/reference/chat/>Chat</a></li><li><a href=https://glimesh.github.io/api-docs/docs/reference/chatparts/>Chat Parts</a></li><li><a href=https://glimesh.github.io/api-docs/docs/reference/mod/>Mod</a></li><li><a href=https://glimesh.github.io/api-docs/docs/reference/scopes/>Scopes</a></li></ul></li><li><a href=https://glimesh.github.io/api-docs/docs/contributing/>Contributing</a></li><li><a href=https://glimesh.github.io/api-docs/docs/dev-app/>Dev App</a></li><li><input type=checkbox id=section-c51f25d1917de848e9ad26913759c6eb class=toggle>
<label for=section-c51f25d1917de848e9ad26913759c6eb class="flex justify-between"><a>Developer Resources</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/developerresources/libraries/>Libraries</a></li><li><a href=https://glimesh.github.io/api-docs/docs/developerresources/tools/>Tools</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/api-docs/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Tokens (Message Parts)</strong>
<label for=toc-control><img src=/api-docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#the-basics>The Basics</a></li><li><a href=#building-the-querysubscription>Building The Query/Subscription</a></li><li><a href=#faq>FAQ</a></li></ul></nav></aside></header><article class=markdown><h1 id=chat-tokens>Chat Tokens
<a class=anchor href=#chat-tokens>#</a></h1><p>Chat tokens are a different way to handle messages sent from chat. A normal message is just a simple string. A chat token is an array of data that shows you all sorts of information about the message and what it contains.</p><blockquote><p>This is a continuation of the websocket tutorial. If you have not already completed the tutorial you can do so <a href=/api-docs/docs/chat/websockets>here</a>. A chat connection is required for this tutorial.</p></blockquote><h2 id=the-basics>The Basics
<a class=anchor href=#the-basics>#</a></h2><p>A chat token is the original message split by several factors.</p><ol><li>Normal text</li><li>Emotes</li><li>URL&rsquo;s</li></ol><p>Using the <code>token</code> property we can identify information we would previously have had to parse. Normal text is exactly what is sounds like. Emotes are emotes from Glimesh. The URL is included as well as the text to create it <code>:glimsmile:</code> . URL&rsquo;s are also detected separately from text. This information is also provided alongside the default <code>message</code> property. This means you don&rsquo;t have to use chat tokens if you don&rsquo;t want to.</p><p><img src=https://i.imgur.com/vCIasEk.png alt="Chat Parts Example"></p><p>As shown in the image above the chat parts contain all the data from the chat message. The original message is above the chat parts.</p><h2 id=building-the-querysubscription>Building The Query/Subscription
<a class=anchor href=#building-the-querysubscription>#</a></h2><p>We need to query <code>chatMessage</code>. We will plan for every possible type of data in a message. If you do not already have a working websocket for Glimesh you need to get one. If you don&rsquo;t want to keep a connection open you can make a normal query to the channel and view the <code>chatMessages</code> property. Either method is valid.</p><p>Start with this subscription</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#66d9ef>subscription</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>chatMessage</span>(channelId:<span style=color:#a6e22e>6</span>) {
</span></span><span style=display:flex><span>    message,
</span></span><span style=display:flex><span>    user {
</span></span><span style=display:flex><span>      id
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    tokens {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>...on</span> EmoteToken {
</span></span><span style=display:flex><span>        src,
</span></span><span style=display:flex><span>        text,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span>,
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>...</span><span style=color:#a6e22e>on</span> TextToken {
</span></span><span style=display:flex><span>        text,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>...</span><span style=color:#a6e22e>on</span> UrlToken {
</span></span><span style=display:flex><span>        text,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>url</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Or use a query.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#66d9ef>query</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>channel</span>(id: <span style=color:#a6e22e>6</span>) {
</span></span><span style=display:flex><span>    chatMessages(last: <span style=color:#a6e22e>5</span>) {
</span></span><span style=display:flex><span>      edges {
</span></span><span style=display:flex><span>        node {
</span></span><span style=display:flex><span>          message
</span></span><span style=display:flex><span>          user {
</span></span><span style=display:flex><span>            id
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          tokens {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>...</span> <span style=color:#66d9ef>on</span> EmoteToken {
</span></span><span style=display:flex><span>              src
</span></span><span style=display:flex><span>              text
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>type</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>...</span> <span style=color:#a6e22e>on</span> TextToken {
</span></span><span style=display:flex><span>              text
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>type</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>...</span> <span style=color:#a6e22e>on</span> UrlToken {
</span></span><span style=display:flex><span>              text
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>type</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>url</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>Make sure to replace 6 with your channel ID!</p></blockquote><p>You don&rsquo;t need to request every property, adjust the request as needed.</p><p>These requests will return the chat message as well as its message parts. The parts are in an array. The array values are generated if the message contains the type requested. If the type does not exist an array value is not generated.</p><p>Example websocket response:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#34;__absinthe__:doc:-576460752302054414:1C57C19163D4D59F61626243BCCA79AB4E50D5C4C2BD8BDA0DDCE83517B20C16&#34;</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#34;subscription:data&#34;</span>,
</span></span><span style=display:flex><span>   {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;result&#34;</span>:{
</span></span><span style=display:flex><span>         <span style=color:#f92672>&#34;data&#34;</span>:{
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;chatMessage&#34;</span>:{
</span></span><span style=display:flex><span>               <span style=color:#f92672>&#34;message&#34;</span>:<span style=color:#e6db74>&#34;Hello Glimesh Devs :glimsmile:&#34;</span>,
</span></span><span style=display:flex><span>               <span style=color:#f92672>&#34;tokens&#34;</span>:[
</span></span><span style=display:flex><span>                  {
</span></span><span style=display:flex><span>                     <span style=color:#f92672>&#34;text&#34;</span>:<span style=color:#e6db74>&#34;Hello Glimesh Devs &#34;</span>,
</span></span><span style=display:flex><span>                     <span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;text&#34;</span>
</span></span><span style=display:flex><span>                  },
</span></span><span style=display:flex><span>                  {
</span></span><span style=display:flex><span>                     <span style=color:#f92672>&#34;src&#34;</span>:<span style=color:#e6db74>&#34;/emotes/svg/glimsmile.svg&#34;</span>,
</span></span><span style=display:flex><span>                     <span style=color:#f92672>&#34;text&#34;</span>:<span style=color:#e6db74>&#34;:glimsmile:&#34;</span>,
</span></span><span style=display:flex><span>                     <span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;emote&#34;</span>,
</span></span><span style=display:flex><span>                     <span style=color:#f92672>&#34;url&#34;</span>:<span style=color:#e6db74>&#34;https://glimesh.tv/emotes/svg/glimsmile-af9a10c9d4c4181dbd87ab245d3e3bee.svg?vsn=d&#34;</span>
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>               ]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>         }
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>     <span style=color:#f92672>&#34;subscriptionId&#34;</span>:<span style=color:#e6db74>&#34;__absinthe__:doc:-576460752302054414:1C57C19163D4D59F61626243BCCA79AB4E50D5C4C2BD8BDA0DDCE83517B20C16&#34;</span>
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><blockquote><p>Message: Hello Glimesh Devs :glimsmile:</p></blockquote><p>Your response will vary slightly depending on the message and the query.</p><h2 id=faq>FAQ
<a class=anchor href=#faq>#</a></h2><p>Q: What happens if I use a nonexistent emote? :fake_emote:</p><blockquote><p>A: Glimesh will realize the emote is not real and detect it as text.</p></blockquote><p>Q: What is the difference between this and the normal chat API?</p><blockquote><p>A: This version is more advanced and all the parsing is done for you.</p></blockquote><p>Q: Should I switch to chat parts?</p><blockquote><p>A: That depends on your project. The normal chat API isn&rsquo;t going away so you can use whichever method you like.</p></blockquote><p>If you have more questions feel free to talk to us in our <a href=https://glimesh.tv/s/discord>discord</a>!</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/Glimesh/api-docs/commit/44c279d2ddff14d61ce6e971dd5846e8518386c6 title='Last modified by MythoAway7 | October 15, 2022' target=_blank rel=noopener><img src=/api-docs/svg/calendar.svg class=book-icon alt=Calendar>
<span>October 15, 2022</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#the-basics>The Basics</a></li><li><a href=#building-the-querysubscription>Building The Query/Subscription</a></li><li><a href=#faq>FAQ</a></li></ul></nav></aside></main></body></html>