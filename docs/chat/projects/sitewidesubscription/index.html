<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.104.2"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Site Wide Chat Messages # The Glimesh API allows you to subscribe to any channel to listen for chat messages. There is no limit to the amount of channels that you can listen to. In this project we will listen for every chat message from every user across the entire site.
Before starting you should fully understand the WebSocket Tutorial.
Starting Up # First we need to open a websocket connection to Glimesh."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content><meta property="og:description" content="Site Wide Chat Messages # The Glimesh API allows you to subscribe to any channel to listen for chat messages. There is no limit to the amount of channels that you can listen to. In this project we will listen for every chat message from every user across the entire site.
Before starting you should fully understand the WebSocket Tutorial.
Starting Up # First we need to open a websocket connection to Glimesh."><meta property="og:type" content="article"><meta property="og:url" content="https://glimesh.github.io/api-docs/docs/chat/projects/sitewidesubscription/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-05-07T21:03:35-05:00"><title>Site Wide Subscription | API-Docs</title><link rel=manifest href=/api-docs/manifest.json><link rel=icon href=/api-docs/favicon.png type=image/x-icon><link rel=stylesheet href=/api-docs/book.min.8cbfebb3cede38504cf8ec2af15528c78f5d6c0aa02b6e39dcffcd3320289b34.css integrity="sha256-jL/rs87eOFBM+Owq8VUox49dbAqgK2453P/NMyAomzQ="><script defer src=/api-docs/en.search.min.0e98b4fe0a8682cc37b5b9e3cafc6e5ca411b392b85d6892e9db0331c415a3a0.js integrity="sha256-Dpi0/gqGgsw3tbnjyvxuXKQRs5K4XWiS6dsDMcQVo6A="></script>
<script src=https://kit.fontawesome.com/a076d05399.js></script>
<script src=https://cdn.jsdelivr.net/npm/react@16/umd/react.production.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/react-dom@16/umd/react-dom.production.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.css><script src=https://cdn.jsdelivr.net/npm/graphql-voyager/dist/voyager.min.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/api-docs><img src=/api-docs/glimesh.png alt=Logo><span>API-Docs</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-bf7b3283e3790c00c8caaa140299052b class=toggle>
<label for=section-bf7b3283e3790c00c8caaa140299052b class="flex justify-between"><a>API</a>
<span>▾</span></label><ul><li><input type=checkbox id=section-ed972e555096d8550e03791bdee2d785 class=toggle>
<label for=section-ed972e555096d8550e03791bdee2d785 class="flex justify-between"><a>API Queries</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/api/query-api/basic-query/>Generic Query</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/query-api/nodejs/node-query/>NodeJS Query</a></li></ul></li><li><a href=https://glimesh.github.io/api-docs/docs/api/api-explorer/>API Explorer</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/migration/>Migration</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/pagination/>Pagination</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/voyager/>Voyager</a></li><li><a href=https://glimesh.github.io/api-docs/docs/api/glimesh-ids/>Glimesh IDs</a></li></ul></li><li><input type=checkbox id=section-46070fb9a15f8281e5989a88905887d2 class=toggle>
<label for=section-46070fb9a15f8281e5989a88905887d2 class="flex justify-between"><a>Authentication</a>
<span>▾</span></label><ul><li><input type=checkbox id=section-cd9d01c15ace32e6fd3da5d1201bcd57 class=toggle>
<label for=section-cd9d01c15ace32e6fd3da5d1201bcd57 class="flex justify-between"><a>Access Token</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/authentication/accesstoken/clientcredentials/>Client Credentials</a></li><li><a href=https://glimesh.github.io/api-docs/docs/authentication/accesstoken/pkceauth/>PKCE</a></li><li><a href=https://glimesh.github.io/api-docs/docs/authentication/accesstoken/accesstoken/>Access Token</a></li><li><a href=https://glimesh.github.io/api-docs/docs/authentication/accesstoken/nodejs/node-access-token/>NodeJS Access Token</a></li></ul></li><li><input type=checkbox id=section-1a1dc1f670e3426ff413fcd1f7e7ec36 class=toggle>
<label for=section-1a1dc1f670e3426ff413fcd1f7e7ec36 class="flex justify-between"><a>Refresh Token</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/authentication/refreshtoken/refreshtoken/>Refresh Token</a></li></ul></li><li><a href=https://glimesh.github.io/api-docs/docs/authentication/auth-explained/>Auth Explained</a></li></ul></li><li><input type=checkbox id=section-05db2d31fc2e5a419ce9fd1c0e938e4e class=toggle checked>
<label for=section-05db2d31fc2e5a419ce9fd1c0e938e4e class="flex justify-between"><a>Chat</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/chat/websockets/>Connecting to Chat</a></li><li><a href=https://glimesh.github.io/api-docs/docs/chat/mutations/>Sending Messages</a></li><li><a href=https://glimesh.github.io/api-docs/docs/chat/chat-tokens/>Tokens (Message Parts)</a></li><li><a href=https://glimesh.github.io/api-docs/docs/chat/moderation/>Moderation</a></li><li><input type=checkbox id=section-9c7ac9316f3056fdea1a344042fc8cb8 class=toggle checked>
<label for=section-9c7ac9316f3056fdea1a344042fc8cb8 class="flex justify-between"><a>Projects</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/chat/projects/sitewidesubscription/ class=active>Site Wide Subscription</a></li><li><a href=https://glimesh.github.io/api-docs/docs/chat/projects/typescriptchatbot/>Typescript Chatbot</a></li></ul></li></ul></li><li><input type=checkbox id=section-0bc4e29f34ae087e007863102c5ba992 class=toggle>
<label for=section-0bc4e29f34ae087e007863102c5ba992 class="flex justify-between"><a>Live Updates</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/live-updates/channels/>Channels</a></li><li><a href=https://glimesh.github.io/api-docs/docs/live-updates/followers/>Followers</a></li><li><a href=https://glimesh.github.io/api-docs/docs/live-updates/subscribers/>Subscribers</a></li><li><a href=https://glimesh.github.io/api-docs/docs/live-updates/explanation/>Live Updates Explained</a></li></ul></li><li><input type=checkbox id=section-084ba1dbb512652712ad881ff8045610 class=toggle>
<label for=section-084ba1dbb512652712ad881ff8045610 class="flex justify-between"><a>Reference</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/reference/channel/>Channel</a></li><li><a href=https://glimesh.github.io/api-docs/docs/reference/chat/>Chat</a></li><li><a href=https://glimesh.github.io/api-docs/docs/reference/chatparts/>Chat Parts</a></li><li><a href=https://glimesh.github.io/api-docs/docs/reference/mod/>Mod</a></li><li><a href=https://glimesh.github.io/api-docs/docs/reference/scopes/>Scopes</a></li></ul></li><li><a href=https://glimesh.github.io/api-docs/docs/contributing/>Contributing</a></li><li><a href=https://glimesh.github.io/api-docs/docs/dev-app/>Dev App</a></li><li><input type=checkbox id=section-c51f25d1917de848e9ad26913759c6eb class=toggle>
<label for=section-c51f25d1917de848e9ad26913759c6eb class="flex justify-between"><a>Developer Resources</a>
<span>▾</span></label><ul><li><a href=https://glimesh.github.io/api-docs/docs/developerresources/libraries/>Libraries</a></li><li><a href=https://glimesh.github.io/api-docs/docs/developerresources/tools/>Tools</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/api-docs/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Site Wide Subscription</strong>
<label for=toc-control><img src=/api-docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#starting-up>Starting Up</a></li><li><a href=#requesting-more-data>Requesting More Data</a></li></ul></nav></aside></header><article class=markdown><h1 id=site-wide-chat-messages>Site Wide Chat Messages
<a class=anchor href=#site-wide-chat-messages>#</a></h1><p>The Glimesh API allows you to subscribe to any channel to listen for chat messages. There is no limit to the amount of channels that you can listen to. In this project we will listen for every chat message from every user across the entire site.</p><blockquote><p>Before starting you should fully understand the <a href=/api-docs/docs/chat/websockets/>WebSocket Tutorial</a>.</p></blockquote><h2 id=starting-up>Starting Up
<a class=anchor href=#starting-up>#</a></h2><p>First we need to open a websocket connection to Glimesh. Use the process from the websocket tutorial linked above to get the connection open. Instead of subscribing to a specific channel you want to subscribe to the <code>chatMessage</code> event. You can do so with this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>[<span style=color:#e6db74>&#34;1&#34;</span>,<span style=color:#e6db74>&#34;1&#34;</span>,<span style=color:#e6db74>&#34;__absinthe__:control&#34;</span>,<span style=color:#e6db74>&#34;doc&#34;</span>,{<span style=color:#f92672>&#34;query&#34;</span>:<span style=color:#e6db74>&#34;subscription{ chatMessage { user { username avatarUrl } message } }&#34;</span>}]
</span></span></code></pre></div><p>Normally the event requires a channel ID as a parameter. Since we don&rsquo;t specify which channel to listen to it connects to every channel on the site. All you have to do is log the messages as they come in!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>[<span style=color:#66d9ef>null</span>,<span style=color:#66d9ef>null</span>,<span style=color:#e6db74>&#34;__absinthe__:doc:-576460752298178591:33B2AA3BF7B8F0E158810EF0E0166F5E05840BE57444C92365C921943942A47D&#34;</span>,<span style=color:#e6db74>&#34;subscription:data&#34;</span>,{<span style=color:#f92672>&#34;result&#34;</span>:{<span style=color:#f92672>&#34;data&#34;</span>:{<span style=color:#f92672>&#34;chatMessage&#34;</span>:{<span style=color:#f92672>&#34;message&#34;</span>:<span style=color:#e6db74>&#34;hello world!&#34;</span>,<span style=color:#f92672>&#34;user&#34;</span>:{<span style=color:#f92672>&#34;avatar&#34;</span>:<span style=color:#e6db74>&#34;/uploads/avatars/Mytho.png?v=63762672056&#34;</span>,<span style=color:#f92672>&#34;username&#34;</span>:<span style=color:#e6db74>&#34;Mytho&#34;</span>}}}},<span style=color:#f92672>&#34;subscriptionId&#34;</span>:<span style=color:#e6db74>&#34;__absinthe__:doc:-576460752298178591:33B2AA3BF7B8F0E158810EF0E0166F5E05840BE57444C92365C921943942A47D&#34;</span>}]
</span></span></code></pre></div><h2 id=requesting-more-data>Requesting More Data
<a class=anchor href=#requesting-more-data>#</a></h2><p>In the example above we requested the message as well as the username and avatar of the chatter. This query shows all of the possible data we can get from a chat message.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#66d9ef>subscription</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>chatMessage</span> {
</span></span><span style=display:flex><span>    id,
</span></span><span style=display:flex><span>    insertedAt,
</span></span><span style=display:flex><span>    message,
</span></span><span style=display:flex><span>    updatedAt,
</span></span><span style=display:flex><span>    isSubscriptionMessage,
</span></span><span style=display:flex><span>    isFollowedMessage,
</span></span><span style=display:flex><span>    channel {
</span></span><span style=display:flex><span>      <span style=color:#75715e># Channel data</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    user {
</span></span><span style=display:flex><span>      <span style=color:#75715e># User data</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    tokens {
</span></span><span style=display:flex><span>        text,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span>,
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>...</span><span style=color:#a6e22e>on</span> EmoteToken {
</span></span><span style=display:flex><span>        src,
</span></span><span style=display:flex><span>        text,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span>,
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>...</span><span style=color:#a6e22e>on</span> TextToken {
</span></span><span style=display:flex><span>        text,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>...</span><span style=color:#a6e22e>on</span> UrlToken {
</span></span><span style=display:flex><span>        text,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>url</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This is all of the info required to listen to every chatroom. If you have any questions talk to us on our <a href=https://discord.gg/Glimesh>Discord</a>.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/Glimesh/api-docs/commit/5a68b23609bda6080e60b59acf78c2d45e335e6f title='Last modified by MythoAway7 | May 8, 2022' target=_blank rel=noopener><img src=/api-docs/svg/calendar.svg class=book-icon alt=Calendar>
<span>May 8, 2022</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#starting-up>Starting Up</a></li><li><a href=#requesting-more-data>Requesting More Data</a></li></ul></nav></aside></main></body></html>